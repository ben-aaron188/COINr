<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Normalisation • COINr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Normalisation">
<meta property="og:description" content="COINr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">COINr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/adjustments.html">Adjustments and Comparisons</a>
    </li>
    <li>
      <a href="../articles/aggregate.html">Aggregation</a>
    </li>
    <li>
      <a href="../articles/analysis.html">Analysis</a>
    </li>
    <li>
      <a href="../articles/coins.html">Building coins</a>
    </li>
    <li>
      <a href="../articles/data_selection.html">Data selection</a>
    </li>
    <li>
      <a href="../articles/denomination.html">Denomination</a>
    </li>
    <li>
      <a href="../articles/imputation.html">Imputation</a>
    </li>
    <li>
      <a href="../articles/normalise.html">Normalisation</a>
    </li>
    <li>
      <a href="../articles/other_functions.html">Other Functions</a>
    </li>
    <li>
      <a href="../articles/overview.html">Overview</a>
    </li>
    <li>
      <a href="../articles/panel_data.html">Panel Data</a>
    </li>
    <li>
      <a href="../articles/results.html">Presenting Results</a>
    </li>
    <li>
      <a href="../articles/screening.html">Unit Screening</a>
    </li>
    <li>
      <a href="../articles/sensitivity.html">Sensitivity Analysis</a>
    </li>
    <li>
      <a href="../articles/treat.html">Outlier Treatment</a>
    </li>
    <li>
      <a href="../articles/v1.html">Changes from COINr v1.0.0</a>
    </li>
    <li>
      <a href="../articles/visualisation.html">Visualisation</a>
    </li>
    <li>
      <a href="../articles/weights.html">Weights</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bluefoxr/COINr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Normalisation</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bluefoxr/COINr/blob/HEAD/vignettes/normalise.Rmd" class="external-link"><code>vignettes/normalise.Rmd</code></a></small>
      <div class="hidden name"><code>normalise.Rmd</code></div>

    </div>

    
    
<p>Normalisation is the operation of bringing indicators onto comparable
scales so that they can be aggregated more fairly. To see why this is
necessary, consider aggregating GDP values (billions or trillions of
dollars) with percentage tertiary graduates (tens of percent). Average
values here would make no sense because one is on a completely different
scale to the other.</p>
<p>The normalisation function in COINr is imaginatively named
<code><a href="../reference/Normalise.html">Normalise()</a></code>. It has the following main features:</p>
<ul>
<li>A wide range of normalisation methods, including the possibility to
pass custom functions</li>
<li>Customisable parameters for normalisation</li>
<li>Possibility to specify detailed individual treatment for each
indicator</li>
</ul>
<p>As of COINr v1.0, <code><a href="../reference/Normalise.html">Normalise()</a></code> is a generic function with
methods for different classes. This means that <code><a href="../reference/Normalise.html">Normalise()</a></code>
can be called on coins, but also on data frames, numeric vectors and
purses (time-indexed collections of coins).</p>
<p>Since <code><a href="../reference/Normalise.html">Normalise()</a></code> might be a bit over-complicated for
some applications, the <code><a href="../reference/qNormalise.html">qNormalise()</a></code> function gives a
simpler interface which might be easier to use. See the <a href="#simplified-normalisation">Simplified normalisation</a>
section.</p>
<div class="section level2">
<h2 id="coins">Coins<a class="anchor" aria-label="anchor" href="#coins"></a>
</h2>
<p>The <code><a href="../reference/Normalise.html">Normalise()</a></code> method for coins follows the familiar
format: you have to specify:</p>
<ul>
<li>
<code>x</code> the coin</li>
<li>
<code>global_specs</code> default specifications to apply to all
indicators</li>
<li>
<code>indiv_specs</code> individual specifications to override
<code>global_specs</code> for specific indicators, if required</li>
<li>
<code>directions</code> a data frame specifying directions - this
overrides the directions in <code>iMeta</code> if specified</li>
<li>
<code>out2</code> whether to output an updated coin or simply a data
frame</li>
</ul>
<p>Let’s begin with a simple example. We build the example coin and
normalise the raw data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bluefoxr.github.io/COINrDoc/" class="external-link">COINr</a></span><span class="op">)</span>

<span class="co"># build example coin</span>
<span class="va">coin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_example_coin.html">build_example_coin</a></span><span class="op">(</span>up_to <span class="op">=</span> <span class="st">"new_coin"</span><span class="op">)</span>
<span class="co">#&gt; iData checked and OK.</span>
<span class="co">#&gt; iMeta checked and OK.</span>
<span class="co">#&gt; Written data set to .$Data$Raw</span>

<span class="co"># normalise the raw data set</span>
<span class="va">coin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Normalise.html">Normalise</a></span><span class="op">(</span><span class="va">coin</span>, dset <span class="op">=</span> <span class="st">"Raw"</span><span class="op">)</span>
<span class="co">#&gt; Written data set to .$Data$Normalised</span></code></pre></div>
<p>We can compare one of the raw and un-normalised indicators side by
side.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_scatter.html">plot_scatter</a></span><span class="op">(</span><span class="va">coin</span>, dsets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Raw"</span>, <span class="st">"Normalised"</span><span class="op">)</span>, iCodes <span class="op">=</span> <span class="st">"Goods"</span><span class="op">)</span></code></pre></div>
<p><img src="normalise_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>This plot also illustrates the linear nature of the min-max
transformation.</p>
<p>The default normalisation uses the min-max approach, scaling
indicators onto the <span class="math inline">\([0, 100]\)</span>
interval. But we can change the normalisation type and its parameters
using the <code>global_specs</code> argument.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">coin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Normalise.html">Normalise</a></span><span class="op">(</span><span class="va">coin</span>, dset <span class="op">=</span> <span class="st">"Raw"</span>,
                   global_specs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>f_n <span class="op">=</span> <span class="st">"n_zscore"</span>,
                                        f_n_para <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Written data set to .$Data$Normalised</span>
<span class="co">#&gt; (overwritten existing data set)</span></code></pre></div>
<p>Again, let’s plot an example of the result:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_scatter.html">plot_scatter</a></span><span class="op">(</span><span class="va">coin</span>, dsets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Raw"</span>, <span class="st">"Normalised"</span><span class="op">)</span>, iCodes <span class="op">=</span> <span class="st">"Goods"</span><span class="op">)</span></code></pre></div>
<p><img src="normalise_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>Again, the z-score transformation is linear. It simply puts the
resulting indicator on a different scale.</p>
<p>Notice the syntax of <code>global_specs</code>. If specified, it
takes entries <code>f_n</code> (the name of the function to apply to
each column) and <code>f_n_para</code> (any further arguments to
<code>f_n</code>, not including <code>x</code>). Importantly,
<code>f_n_para</code> <em>must</em> be specified as a list, even if it
only contains one parameter.</p>
<p>Since <code>f_n</code> points to a function name, any function can be
passed to <code><a href="../reference/Normalise.html">Normalise()</a></code> as long as it is available in the
namespace. To illustrate, consider an example where we want to
categorise into discrete bins. We can use base R’s <code><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut()</a></code>
function for this purpose. We simply need to specify the number of bins.
We could directly call <code><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut()</a></code>, but for clarity we will
create a simple wrapper function around it, then pass that function to
<code><a href="../reference/Normalise.html">Normalise()</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># wrapper function</span>
<span class="va">f_bin</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">nbins</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">x</span>, breaks <span class="op">=</span> <span class="va">nbins</span>, labels <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># pass wrapper to normalise, specify 5 bins</span>
<span class="va">coin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Normalise.html">Normalise</a></span><span class="op">(</span><span class="va">coin</span>, dset <span class="op">=</span> <span class="st">"Raw"</span>,
                   global_specs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>f_n <span class="op">=</span> <span class="st">"f_bin"</span>,
                                        f_n_para <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nbins <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Written data set to .$Data$Normalised</span>
<span class="co">#&gt; (overwritten existing data set)</span></code></pre></div>
<p>To illustrate the difference with the linear transformations above,
we again plot the raw against normalised indicator:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_scatter.html">plot_scatter</a></span><span class="op">(</span><span class="va">coin</span>, dsets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Raw"</span>, <span class="st">"Normalised"</span><span class="op">)</span>, iCodes <span class="op">=</span> <span class="st">"Goods"</span><span class="op">)</span></code></pre></div>
<p><img src="normalise_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>Obviously this is <em>not</em> linear.</p>
<p>Generally, the requirements of a function to be passed to
<code><a href="../reference/Normalise.html">Normalise()</a></code> are that its first argument should be
<code>x</code>, a numeric vector, and it should return a numeric vector
of the same length as <code>x</code>. It should also be able to handle
<code>NA</code>s. Any further arguments can be passed via the
<code>f_n_para</code> entry.</p>
<p>By default, the directions are taken from the coin. These will have
been specified as the <code>Direction</code> column of
<code>iMeta</code> when constructing a coin with
<code><a href="../reference/new_coin.html">new_coin()</a></code>. However, you can specify different directions
using the <code>directions</code> argument of <code>normalise()</code>:
in this case you need to specify a data frame with two columns:
<code>iCode</code> (with an entry for each indicator code found in the
target data set) and <code>Direction</code> giving the direction as -1
or 1.</p>
<p>To show an example, we take the existing directions from the coin,
modify them slightly, and then run the normalisation function again:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># get directions from coin</span>
<span class="va">directions</span> <span class="op">&lt;-</span> <span class="va">coin</span><span class="op">$</span><span class="va">Meta</span><span class="op">$</span><span class="va">Ind</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"iCode"</span>, <span class="st">"Direction"</span><span class="op">)</span><span class="op">]</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">directions</span>, <span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt;       iCode Direction</span>
<span class="co">#&gt; 9     Goods         1</span>
<span class="co">#&gt; 10 Services         1</span>
<span class="co">#&gt; 11      FDI         1</span>
<span class="co">#&gt; 12   PRemit         1</span>
<span class="co">#&gt; 13  ForPort         1</span>
<span class="co">#&gt; 31    Renew         1</span>
<span class="co">#&gt; 32 PrimEner        -1</span>
<span class="co">#&gt; 33      CO2        -1</span>
<span class="co">#&gt; 34   MatCon        -1</span>
<span class="co">#&gt; 35   Forest        -1</span></code></pre></div>
<p>We’ll change the direction of the “Goods” indicator and
re-normalise:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># change Goods to -1</span>
<span class="va">directions</span><span class="op">$</span><span class="va">Direction</span><span class="op">[</span><span class="va">directions</span><span class="op">$</span><span class="va">iCode</span> <span class="op">==</span> <span class="st">"Goods"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span>

<span class="co"># re-run (using min max default)</span>
<span class="va">coin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Normalise.html">Normalise</a></span><span class="op">(</span><span class="va">coin</span>, dset <span class="op">=</span> <span class="st">"Raw"</span>, directions <span class="op">=</span> <span class="va">directions</span><span class="op">)</span>
<span class="co">#&gt; Written data set to .$Data$Normalised</span>
<span class="co">#&gt; (overwritten existing data set)</span></code></pre></div>
<p>Finally let’s explore how to specify different normalisation methods
for different indicators. The <code>indiv_specs</code> argument takes a
named list for each indicator, and will override the specifications in
<code>global_specs</code>. If <code>indiv_specs</code> is specified, we
only need to include sub-lists for indicators that differ from
<code>global_specs</code>.</p>
<p>To illustrate, we can use a contrived example where we might want to
apply min-max to all indicators except two. For those, we apply a rank
transformation and distance to maximum approach. Note, that since the
default of <code>global_specs</code> is min-max, we don’t need to
specify that at all here.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># individual specifications:</span>
<span class="co"># LPI - borda scores</span>
<span class="co"># Flights - z-scores with mean 10 and sd 2</span>
<span class="va">indiv_specs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
  LPI <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>f_n <span class="op">=</span> <span class="st">"n_borda"</span><span class="op">)</span>,
  Flights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>f_n <span class="op">=</span> <span class="st">"n_zscore"</span>,
                 f_n_para <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m_sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># normalise</span>
<span class="va">coin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Normalise.html">Normalise</a></span><span class="op">(</span><span class="va">coin</span>, dset <span class="op">=</span> <span class="st">"Raw"</span>, indiv_specs <span class="op">=</span> <span class="va">indiv_specs</span><span class="op">)</span>
<span class="co">#&gt; Written data set to .$Data$Normalised</span>
<span class="co">#&gt; (overwritten existing data set)</span>

<span class="co"># a quick look at the first three indicators</span>
<span class="fu"><a href="../reference/get_dset.html">get_dset</a></span><span class="op">(</span><span class="va">coin</span>, <span class="st">"Normalised"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span> |&gt;
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt;    uCode LPI   Flights      Ship</span>
<span class="co">#&gt; 1    AUS  36  9.889993  66.14497</span>
<span class="co">#&gt; 2    AUT  44  9.588735   0.00000</span>
<span class="co">#&gt; 3    BEL  45  9.711512  97.14314</span>
<span class="co">#&gt; 4    BGD   4  8.529810  45.80661</span>
<span class="co">#&gt; 5    BGR   7  8.741971  37.40495</span>
<span class="co">#&gt; 6    BRN   9  8.433044  35.38920</span>
<span class="co">#&gt; 7    CHE  42 10.563483   0.00000</span>
<span class="co">#&gt; 8    CHN  30 13.235114 100.00000</span>
<span class="co">#&gt; 9    CYP  14  8.721372  55.21211</span>
<span class="co">#&gt; 10   CZE  31  9.001961   0.00000</span></code></pre></div>
<p>This example is meant to be illustrative of the functionality of
<code><a href="../reference/Normalise.html">Normalise()</a></code>, rather than being a sensible normalisation
strategy, because the indicators are now on very different ranges.</p>
<p>In practice, if different normalisation strategies are selected, it
is a good idea to keep the indicators on similar ranges, otherwise the
effects will be very unequal in the aggregation step.</p>
</div>
<div class="section level2">
<h2 id="data-frames-and-vectors">Data frames and vectors<a class="anchor" aria-label="anchor" href="#data-frames-and-vectors"></a>
</h2>
<p>Normalising a data frame is very similar to normalising a coin,
except the input is a data frame and output is also a data frame.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mtcars_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Normalise.html">Normalise</a></span><span class="op">(</span><span class="va">mtcars</span>, global_specs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>f_n <span class="op">=</span> <span class="st">"n_dist2max"</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mtcars_n</span><span class="op">)</span>
<span class="co">#&gt;         mpg cyl      disp        hp      drat        wt      qsec vs am gear</span>
<span class="co">#&gt; 1 0.4510638 0.5 0.2217511 0.2049470 0.5253456 0.2830478 0.2333333  0  1  0.5</span>
<span class="co">#&gt; 2 0.4510638 0.5 0.2217511 0.2049470 0.5253456 0.3482485 0.3000000  0  1  0.5</span>
<span class="co">#&gt; 3 0.5276596 0.0 0.0920429 0.1448763 0.5023041 0.2063411 0.4892857  1  1  0.5</span>
<span class="co">#&gt; 4 0.4680851 0.5 0.4662010 0.2049470 0.1474654 0.4351828 0.5880952  1  0  0.0</span>
<span class="co">#&gt; 5 0.3531915 1.0 0.7206286 0.4346290 0.1797235 0.4927129 0.3000000  0  0  0.0</span>
<span class="co">#&gt; 6 0.3276596 0.5 0.3838863 0.1872792 0.0000000 0.4978266 0.6809524  1  0  0.0</span>
<span class="co">#&gt;        carb</span>
<span class="co">#&gt; 1 0.4285714</span>
<span class="co">#&gt; 2 0.4285714</span>
<span class="co">#&gt; 3 0.0000000</span>
<span class="co">#&gt; 4 0.0000000</span>
<span class="co">#&gt; 5 0.1428571</span>
<span class="co">#&gt; 6 0.0000000</span></code></pre></div>
<p>As with coins, columns can be normalised with individual
specifications using the <code>indiv_spec</code> argument in exactly the
same way as with a coin. Note that non-numeric columns are always
ignored:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/Normalise.html">Normalise</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span>
<span class="co">#&gt; 1    22.222222    62.50000     6.779661    4.166667  setosa</span>
<span class="co">#&gt; 2    16.666667    41.66667     6.779661    4.166667  setosa</span>
<span class="co">#&gt; 3    11.111111    50.00000     5.084746    4.166667  setosa</span>
<span class="co">#&gt; 4     8.333333    45.83333     8.474576    4.166667  setosa</span>
<span class="co">#&gt; 5    19.444444    66.66667     6.779661    4.166667  setosa</span>
<span class="co">#&gt; 6    30.555556    79.16667    11.864407   12.500000  setosa</span></code></pre></div>
<p>There is also a method for numeric vectors, although usually it is
just as easy to call the underlying normalisation function directly.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># example vector</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>

<span class="co"># normalise using distance to reference (5th data point)</span>
<span class="va">x_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Normalise.html">Normalise</a></span><span class="op">(</span><span class="va">x</span>, f_n <span class="op">=</span> <span class="st">"n_dist2ref"</span>, f_n_para <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>iref <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span>

<span class="co"># view side by side</span>
<span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">x_norm</span><span class="op">)</span>
<span class="co">#&gt;             x    x_norm</span>
<span class="co">#&gt; 1  0.38269397 0.8745022</span>
<span class="co">#&gt; 2  0.95480428 2.2628311</span>
<span class="co">#&gt; 3  0.11428679 0.2231637</span>
<span class="co">#&gt; 4  0.02232424 0.0000000</span>
<span class="co">#&gt; 5  0.43440982 1.0000000</span>
<span class="co">#&gt; 6  0.29381397 0.6588188</span>
<span class="co">#&gt; 7  0.71240164 1.6745973</span>
<span class="co">#&gt; 8  0.22607436 0.4944364</span>
<span class="co">#&gt; 9  0.13198070 0.2661012</span>
<span class="co">#&gt; 10 0.46404062 1.0719045</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="purses">Purses<a class="anchor" aria-label="anchor" href="#purses"></a>
</h2>
<p>The purse method for <code>normalise()</code> is especially useful if
you are working with multiple coins and panel data. This is because to
make scores comparable from one time point to the next, it is usually a
good idea to normalise indicators together rather than separately. For
example, with the min-max method, indicators are typically normalised
using the minimum and maximum over all time points of data, as opposed
to having a separate max and min for each.</p>
<p>If indicators were normalised separately for each time point, then
the highest scoring unit would get a score of 100 in time <span class="math inline">\(t\)</span> (assuming min-max between 0 and 100),
but the highest scoring unit in time <span class="math inline">\(t+1\)</span> would <em>also</em> be assigned a
score of 100. The underlying values of these two scores could be very
different, but they would get</p>
<p>This means that the purse method for <code>normalise()</code> is a
bit different from most other purse methods, because it doesn’t
independently apply the function to each coin, but takes the coins all
together. This has the following implications:</p>
<ol style="list-style-type: decimal">
<li>Any normalisation function can be applied globally to all coins in a
purse, ensuring comparability. BUT:</li>
<li>If normalisation is done globally, it is no longer possible to
automatically regenerate coins in the purse (i.e. using
<code>regenerate()</code>), because the coin is no longer
self-contained: it needs to know the values of the other coins in the
purse. Perhaps at some point I will add a dedicated method for
regenerating entire purses, but we are not there yet.</li>
</ol>
<p>Let’s anyway illustrate with an example. We build the example purse
first.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">purse</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_example_purse.html">build_example_purse</a></span><span class="op">(</span>quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>Normalising a purse works in exactly the same way as normalising a
coin, except for the <code>global</code> argument. By default,
<code>global = TRUE</code>, which means that the normalisation will be
applied over all time points simultaneously, with the aim of making the
index comparable. Here, we will apply the default min-max approach to
all coins:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">purse</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Normalise.html">Normalise</a></span><span class="op">(</span><span class="va">purse</span>, dset <span class="op">=</span> <span class="st">"Raw"</span>, global <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Written data set to .$Data$Normalised</span>
<span class="co">#&gt; (overwritten existing data set)</span>
<span class="co">#&gt; Written data set to .$Data$Normalised</span>
<span class="co">#&gt; (overwritten existing data set)</span>
<span class="co">#&gt; Written data set to .$Data$Normalised</span>
<span class="co">#&gt; (overwritten existing data set)</span>
<span class="co">#&gt; Written data set to .$Data$Normalised</span>
<span class="co">#&gt; (overwritten existing data set)</span>
<span class="co">#&gt; Written data set to .$Data$Normalised</span>
<span class="co">#&gt; (overwritten existing data set)</span></code></pre></div>
<p>Now let’s examine the data set of the first coin. We’ll see what the
max and min of a few indicators is:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># get normalised data of first coin in purse</span>
<span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_dset.html">get_dset</a></span><span class="op">(</span><span class="va">purse</span><span class="op">$</span><span class="va">coin</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, dset <span class="op">=</span> <span class="st">"Normalised"</span><span class="op">)</span>

<span class="co"># get min and max of first four indicators (exclude uCode col)</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">x1</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, <span class="va">min</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt;     LPI Flights    Ship    Bord </span>
<span class="co">#&gt;       0       0       0       0</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">x1</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, <span class="va">max</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt;      LPI  Flights     Ship     Bord </span>
<span class="co">#&gt; 83.98913 88.79325 85.91861 93.62416</span></code></pre></div>
<p>Here we see that the minimum values are zero, but the maximum values
are <em>not</em> 100, because in other coins these indicators have
higher values. To show that the global maximum is indeed 100, we can
extract the whole normalised data set for all years and run the same
check.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># get entire normalised data set for all coins in one df</span>
<span class="va">x1_global</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_dset.html">get_dset</a></span><span class="op">(</span><span class="va">purse</span>, dset <span class="op">=</span> <span class="st">"Normalised"</span><span class="op">)</span>

<span class="co"># get min and max of first four indicators (exclude Time and uCode cols)</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">x1_global</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>, <span class="va">min</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt;     LPI Flights    Ship    Bord </span>
<span class="co">#&gt;       0       0       0       0</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">x1_global</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>, <span class="va">max</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt;     LPI Flights    Ship    Bord </span>
<span class="co">#&gt;     100     100     100     100</span></code></pre></div>
<p>And this confirms our expectations: that the global maximum and
minimum are 0 and 100 respectively.</p>
<p>Any type of normalisation can be performed on a purse in this
“global” mode. However, keep in mind what is going on. Simply put, when
<code>global = TRUE</code> this is what happens:</p>
<ol style="list-style-type: decimal">
<li>The data sets from each coin are joined together into one using the
<code><a href="../reference/get_dset.html">get_dset()</a></code> function.</li>
<li>Normalisation is applied to this global data set.</li>
<li>The global data set is then split back into the coins.</li>
</ol>
<p>So if you specify to normalise by e.g. rank, ranks will be calculated
for all time points. Therefore, consider carefully if this fits the
intended meaning.</p>
<p>Normalisation can also be performed independently on each coin, by
setting <code>global = FALSE</code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">purse</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Normalise.html">Normalise</a></span><span class="op">(</span><span class="va">purse</span>, dset <span class="op">=</span> <span class="st">"Raw"</span>, global <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; Written data set to .$Data$Normalised</span>
<span class="co">#&gt; (overwritten existing data set)</span>
<span class="co">#&gt; Written data set to .$Data$Normalised</span>
<span class="co">#&gt; (overwritten existing data set)</span>
<span class="co">#&gt; Written data set to .$Data$Normalised</span>
<span class="co">#&gt; (overwritten existing data set)</span>
<span class="co">#&gt; Written data set to .$Data$Normalised</span>
<span class="co">#&gt; (overwritten existing data set)</span>
<span class="co">#&gt; Written data set to .$Data$Normalised</span>
<span class="co">#&gt; (overwritten existing data set)</span>

<span class="co"># get normalised data of first coin in purse</span>
<span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_dset.html">get_dset</a></span><span class="op">(</span><span class="va">purse</span><span class="op">$</span><span class="va">coin</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, dset <span class="op">=</span> <span class="st">"Normalised"</span><span class="op">)</span>

<span class="co"># get min and max of first four indicators (exclude uCode col)</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">x1</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, <span class="va">min</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt;     LPI Flights    Ship    Bord </span>
<span class="co">#&gt;       0       0       0       0</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">x1</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, <span class="va">max</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt;     LPI Flights    Ship    Bord </span>
<span class="co">#&gt;     100     100     100     100</span></code></pre></div>
<p>Now the normalised data set in each coin will have a min and max of 0
and 100 respectively, for each indicator.</p>
</div>
<div class="section level2">
<h2 id="simplified-normalisation">Simplified normalisation<a class="anchor" aria-label="anchor" href="#simplified-normalisation"></a>
</h2>
<p>If the syntax of <code><a href="../reference/Normalise.html">Normalise()</a></code> looks a bit
over-complicated, you can use the simpler <code><a href="../reference/qNormalise.html">qNormalise()</a></code>
function, which has less flexibility but makes the key function
arguments more visible (they are not wrapped in lists). This function
applies the same normalisation method to all indicators. It is also a
generic so can be used on data frames, coins and purses. Let’s
demonstrate on a data frame:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># some made up data</span>
<span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>uCode <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>,
                a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>,
                b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span>

<span class="va">X</span>
<span class="co">#&gt;    uCode          a         b</span>
<span class="co">#&gt; 1      a 0.22916214 90.721525</span>
<span class="co">#&gt; 2      b 0.57414434 90.043749</span>
<span class="co">#&gt; 3      c 0.20335382 91.500001</span>
<span class="co">#&gt; 4      d 0.77594736 93.037526</span>
<span class="co">#&gt; 5      e 0.45742369  2.721944</span>
<span class="co">#&gt; 6      f 0.94752939 65.796869</span>
<span class="co">#&gt; 7      g 0.09101603 62.718095</span>
<span class="co">#&gt; 8      h 0.65381020 31.422129</span>
<span class="co">#&gt; 9      i 0.31797983  4.706388</span>
<span class="co">#&gt; 10     j 0.70911309 54.108744</span></code></pre></div>
<p>By default, normalisation results in min-max on the <span class="math inline">\([0, 100]\)</span> interval:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/qNormalise.html">qNormalise</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>
<span class="co">#&gt;    uCode         a          b</span>
<span class="co">#&gt; 1      a  16.12889  97.435658</span>
<span class="co">#&gt; 2      b  56.40640  96.685205</span>
<span class="co">#&gt; 3      c  13.11571  98.297609</span>
<span class="co">#&gt; 4      d  79.96738 100.000000</span>
<span class="co">#&gt; 5      e  42.77898   0.000000</span>
<span class="co">#&gt; 6      f 100.00000  69.838365</span>
<span class="co">#&gt; 7      g   0.00000  66.429458</span>
<span class="co">#&gt; 8      h  65.70758  31.777667</span>
<span class="co">#&gt; 9      i  26.49857   2.197234</span>
<span class="co">#&gt; 10     j  72.16432  56.896937</span></code></pre></div>
<p>We can pass another normalisation function if we like, and the syntax
is a bit easier than <code><a href="../reference/Normalise.html">Normalise()</a></code>:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/qNormalise.html">qNormalise</a></span><span class="op">(</span><span class="va">X</span>, f_n <span class="op">=</span> <span class="st">"n_dist2ref"</span>, f_n_para <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>iref <span class="op">=</span> <span class="fl">1</span>, cap_max <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;    uCode        a          b</span>
<span class="co">#&gt; 1      a 1.000000 1.00000000</span>
<span class="co">#&gt; 2      b 1.000000 0.99229796</span>
<span class="co">#&gt; 3      c 0.813181 1.00000000</span>
<span class="co">#&gt; 4      d 1.000000 1.00000000</span>
<span class="co">#&gt; 5      e 1.000000 0.00000000</span>
<span class="co">#&gt; 6      f 1.000000 0.71676393</span>
<span class="co">#&gt; 7      g 0.000000 0.68177769</span>
<span class="co">#&gt; 8      h 1.000000 0.32614002</span>
<span class="co">#&gt; 9      i 1.000000 0.02255061</span>
<span class="co">#&gt; 10     j 1.000000 0.58394368</span></code></pre></div>
<p>The <code><a href="../reference/qNormalise.html">qNormalise()</a></code> function works in a similar way for
coins and purses.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by William Becker.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
